{
 "cells": [
  {"cell_type": "markdown", "metadata": {}, "source": ["# Data Analysis - Module 6\n", "## Real-World Capstone Projects\n", "\n", "**Your Role:** Senior Data Analyst at TechFlow\n", "\n", "**Your Mission:** Apply everything you've learned to solve real business problems.\n", "\n", "**4 Projects:**\n", "| # | Project | Departments |\n", "|---|---------|-------------|\n", "| 1 | Customer 360 Analysis | All Teams |\n", "| 2 | Revenue Intelligence | Finance, Sales |\n", "| 3 | Churn Prevention | CS, Product |\n", "| 4 | Executive Report | Leadership |\n", "\n", "**Time:** 3-4 hours\n", "\n", "---"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["# SETUP: Load All Data"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["```python\n", "import pandas as pd\n", "import numpy as np\n", "import matplotlib.pyplot as plt\n", "import seaborn as sns\n", "\n", "sns.set_style('whitegrid')\n", "%matplotlib inline\n", "\n", "# Load datasets\n", "customers = pd.read_csv('../dataset/TechFlow.csv')\n", "orders = pd.read_csv('../dataset/orders.csv')\n", "products = pd.read_csv('../dataset/products.csv')\n", "regions = pd.read_csv('../dataset/customer_regions.csv')\n", "tickets = pd.read_csv('../dataset/support_tickets.tsv', sep='\\t')\n", "surveys = pd.read_csv('../dataset/nps_surveys.csv')\n", "daily = pd.read_csv('../dataset/daily_metrics.csv')\n", "daily['Date'] = pd.to_datetime(daily['Date'])\n", "\n", "print('Datasets loaded!')\n", "```"]},
  {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": ["# ↓ Type the code below, then press Shift+Enter to run\n"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["---\n", "# PROJECT 1: Customer 360 Analysis\n", "\n", "**Goal:** Create a complete view of each customer by combining all data sources.\n", "\n", "**Deliverables:**\n", "- Unified customer dataset\n", "- Customer health scoring\n", "- Risk categorization\n", "- Visual dashboard"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["## 1.1 Build Customer Master Dataset\n", "\n", "Start with base customer data and add ticket information."]},
  {"cell_type": "markdown", "metadata": {}, "source": ["```python\n", "# Start with base data\n", "customer_360 = customers.copy()\n", "\n", "# Add ticket counts per customer\n", "ticket_summary = tickets.groupby('CustomerID').agg(\n", "    total_tickets=('TicketID', 'count'),\n", "    high_priority=('Priority', lambda x: (x == 'High').sum())\n", ").reset_index()\n", "\n", "customer_360 = customer_360.merge(ticket_summary, on='CustomerID', how='left')\n", "customer_360['total_tickets'] = customer_360['total_tickets'].fillna(0)\n", "\n", "print(f'Shape: {customer_360.shape}')\n", "customer_360[['CompanyName', 'total_tickets', 'high_priority']].head()\n", "```"]},
  {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": ["# ↓ Type the code below, then press Shift+Enter to run\n"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["## 1.2 Add Survey Data"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["```python\n", "# Aggregate NPS survey data\n", "survey_summary = surveys.groupby('CustomerID').agg(\n", "    survey_count=('SurveyID', 'count'),\n", "    avg_survey_nps=('NPS_Score', 'mean'),\n", "    latest_nps=('NPS_Score', 'last')\n", ").reset_index()\n", "\n", "customer_360 = customer_360.merge(survey_summary, on='CustomerID', how='left')\n", "customer_360[['CompanyName', 'NPS_Score', 'avg_survey_nps', 'survey_count']].head(10)\n", "```"]},
  {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": ["# ↓ Type the code below, then press Shift+Enter to run\n"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["## 1.3 Create Customer Segments"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["```python\n", "# Revenue Tier\n", "customer_360['RevenueTier'] = pd.cut(\n", "    customer_360['MonthlyRevenue'],\n", "    bins=[0, 100, 300, 600, 1000],\n", "    labels=['Bronze', 'Silver', 'Gold', 'Platinum']\n", ")\n", "\n", "# Engagement Level\n", "customer_360['EngagementLevel'] = pd.cut(\n", "    customer_360['AvgWeeklyLogins'],\n", "    bins=[0, 20, 50, 100, 500],\n", "    labels=['Dormant', 'Low', 'Medium', 'High']\n", ")\n", "\n", "print('Revenue Tier Distribution:')\n", "print(customer_360['RevenueTier'].value_counts())\n", "print('\\nEngagement Distribution:')\n", "print(customer_360['EngagementLevel'].value_counts())\n", "```"]},
  {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": ["# ↓ Type the code below, then press Shift+Enter to run\n"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["## 1.4 Calculate Health Score"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["```python\n", "# Health Score (0-100)\n", "# Components: NPS (30), Engagement (30), Tenure (20), Support (20)\n", "\n", "customer_360['HealthScore'] = (\n", "    (customer_360['NPS_Score'] / 10 * 30) +\n", "    (customer_360['AvgWeeklyLogins'].clip(upper=100) / 100 * 30) +\n", "    (customer_360['TenureMonths'].clip(upper=24) / 24 * 20) +\n", "    (20 - customer_360['SupportTicketsRaised'].clip(upper=10) * 2)\n", ").round(0)\n", "\n", "# Risk Category\n", "customer_360['RiskCategory'] = pd.cut(\n", "    customer_360['HealthScore'],\n", "    bins=[0, 40, 60, 80, 100],\n", "    labels=['Critical', 'High', 'Medium', 'Low']\n", ")\n", "\n", "print('Health Score Statistics:')\n", "print(customer_360['HealthScore'].describe())\n", "print('\\nRisk Distribution:')\n", "print(customer_360['RiskCategory'].value_counts())\n", "```"]},
  {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": ["# ↓ Type the code below, then press Shift+Enter to run\n"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["## 1.5 Analyze Risk by Segment"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["```python\n", "# Risk summary by Revenue Tier\n", "risk_by_tier = customer_360.groupby('RevenueTier').agg(\n", "    customers=('CustomerID', 'count'),\n", "    avg_health=('HealthScore', 'mean'),\n", "    revenue_at_risk=('MonthlyRevenue', 'sum'),\n", "    churn_rate=('Cancelled', 'mean')\n", ").round(2)\n", "\n", "risk_by_tier['churn_rate'] = (risk_by_tier['churn_rate'] * 100).round(1)\n", "print('Risk Analysis by Revenue Tier:')\n", "risk_by_tier\n", "```"]},
  {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": ["# ↓ Type the code below, then press Shift+Enter to run\n"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["## 1.6 Customer 360 Dashboard"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["```python\n", "fig, axes = plt.subplots(2, 3, figsize=(16, 10))\n", "\n", "# 1. Revenue by Tier\n", "tier_rev = customer_360.groupby('RevenueTier')['MonthlyRevenue'].sum()\n", "axes[0,0].pie(tier_rev, labels=tier_rev.index, autopct='%1.1f%%')\n", "axes[0,0].set_title('Revenue by Customer Tier')\n", "\n", "# 2. Health Score Distribution\n", "sns.histplot(customer_360['HealthScore'], bins=20, ax=axes[0,1], color='steelblue')\n", "axes[0,1].axvline(60, color='orange', linestyle='--', label='Risk Threshold')\n", "axes[0,1].set_title('Health Score Distribution')\n", "\n", "# 3. Risk by Plan\n", "risk_plan = pd.crosstab(customer_360['SubscriptionPlan'], customer_360['RiskCategory'], normalize='index') * 100\n", "risk_plan.plot(kind='bar', stacked=True, ax=axes[0,2], colormap='RdYlGn_r')\n", "axes[0,2].set_title('Risk by Plan (%)')\n", "\n", "# 4. Engagement vs Revenue\n", "colors = customer_360['RiskCategory'].map({'Critical':'red', 'High':'orange', 'Medium':'yellow', 'Low':'green'})\n", "axes[1,0].scatter(customer_360['AvgWeeklyLogins'], customer_360['MonthlyRevenue'], c=colors, alpha=0.6)\n", "axes[1,0].set_xlabel('Weekly Logins')\n", "axes[1,0].set_ylabel('Revenue')\n", "axes[1,0].set_title('Engagement vs Revenue')\n", "\n", "# 5. Risk Distribution\n", "risk_counts = customer_360['RiskCategory'].value_counts().reindex(['Low', 'Medium', 'High', 'Critical'])\n", "axes[1,1].bar(risk_counts.index, risk_counts.values, color=['green', 'yellow', 'orange', 'red'])\n", "axes[1,1].set_title('Customer Risk Distribution')\n", "\n", "# 6. Industry Mix\n", "industry_counts = customer_360['Industry'].value_counts().head(6)\n", "axes[1,2].barh(industry_counts.index, industry_counts.values, color='purple')\n", "axes[1,2].set_title('Top Industries')\n", "axes[1,2].invert_yaxis()\n", "\n", "plt.suptitle('CUSTOMER 360 DASHBOARD', fontsize=16, fontweight='bold')\n", "plt.tight_layout()\n", "plt.show()\n", "```"]},
  {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": ["# ↓ Type the code below, then press Shift+Enter to run\n"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["## 1.7 Priority Action List"]},
  {"cell_type": "markdown", "metadata": {}, "source": ["```python\n", "# Top 10 at-risk customers by revenue\n", "priority_list = customer_360[\n", "    (customer_360['RiskCategory'].isin(['Critical', 'High'])) & \n", "    (customer_360['Cancelled'] == 0)\n", "].nlargest(10, 'MonthlyRevenue')[[\n", "    'CompanyName', 'Industry', 'MonthlyRevenue', 'HealthScore', 'NPS_Score', 'RiskCategory'\n", "]]\n", "\n", "print('='*70)\n", "print('TOP 10 AT-RISK CUSTOMERS - IMMEDIATE ACTION REQUIRED')\n", "print('='*70)\n", "priority_list\n", "```"]},
  {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": ["# ↓ Type the code below, then press Shift+Enter to run\n"]}
 ],
 "metadata": {"kernelspec": {"display_name": "Python 3", "language": "python", "name": "python3"}},
 "nbformat": 4,
 "nbformat_minor": 4
}
